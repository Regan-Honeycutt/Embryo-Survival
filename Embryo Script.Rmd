---
title: "Embryo Script"
author: "Regan Honeycutt"
date: "2/15/2022"
output: html_document
---

```{R Data}

total_embryo <- read.csv("./total_embryo.csv")


```




```{R General Linear Regression}

#Essentially I think just changing the colors of the regression graph, adding a boxplot of the means at t=7, labeling the x axis of regression graph, including anova data(?), and figuring out what literally the glm graphs mean.

          #Boxplot created, and I like the colors used. X-axis             labeled. Also ran a glm and anova on final time point



xrange = range(total_embryo$Time)

embryo_time_glm <- glm(population ~ Time + treatment + Time:treatment, data = total_embryo, family = "poisson")

summary(embryo_time_glm)
car::Anova(embryo_time_glm)
plot(embryo_time_glm)


plot(population ~ Time , data = total_embryo, type = "n", xlab= "Time (Days)", ylab = "Population Size", xlim = range(total_embryo$Time), ylim = range(total_embryo$population))

#Control points and regression line
points(population ~ Time, data = total_embryo, subset = treatment == "control",
       pch = 16, col = "lightgoldenrod2")
xrange = range(total_embryo$Time[total_embryo$treatment == "control"])
lines(xrange,
      predict(embryo_time_glm,
              newdata = data.frame(Time = range(total_embryo$Time), treatment =
              "control")), col ="lightgoldenrod2",
              lty = 1)

#4ppt points and regression line
points(population ~ Time, data = total_embryo, subset = treatment == "4ppt",
       pch = 16, col = "sienna2")
xrange = range(total_embryo$Time[total_embryo$treatment ==
                                   "4ppt"])
lines(xrange,
      predict(embryo_time_glm,
              newdata = data.frame(Time = range(total_embryo$Time), treatment =
              "4ppt")), col = "sienna2", lty = 1)

#6ppt points and regression line
points(population ~ Time, data = total_embryo, subset = treatment == "6ppt",
       pch = 16, col = "orangered4")
xrange = range(total_embryo$Time[total_embryo$treatment ==
                                   "6ppt"])
lines(xrange,
      predict(embryo_time_glm,
              newdata = data.frame(Time = range(total_embryo$Time), treatment =
              "6ppt")), col = "orangered4", lty = 1)

#legend
legend('left', c('Control', '4ppt', '6ppt'), cex = .7, col = c('lightgoldenrod2', 'sienna2', 'orangered4'), 
       pch = 16, lty = c(1, 1, 1), bty = 'n')



```
```{R Boxplot}

end_glm <- glm(population ~ Time + treatment + Time:treatment, data = total_embryo, subset = Time == "7", family = "poisson")
summary(end_glm)

car::Anova(end_glm)
plot(end_glm)

total_embryo$treatment <- factor(total_embryo$treatment, levels = c('control', '4ppt', '6ppt'))


boxplot(population ~ treatment, data = total_embryo, subset = Time== "7", xlab = "Treatment", ylab = "Population Size", col = c('lightgoldenrod2', 'sienna2', 'orangered4'))








```
```{R ggplot}

library(ggplot2)
library(gridExtra)
library(scatterplot3d)
library(MASS)

p1 <- ggplot(data = total_embryo, subset = total_embryo$Time == "7",
             mapping = aes(x = treatment, y = population, group = 3, col(c()) +
      geom_point() +
      geom_smooth(method = "lm") +
      labs(x = "Treatment", y = "Population Size")

grid.arrange(p1, nrow = 1)


#Attempt #2


plot(1:3, 1:3, type = "n", data = total_embryo, subset = total_embryo$Time == "7",ylim = range(total_embryo$population), axes = F,
     xlim = c(1 ,3),
     xlab = "Treatment", ylab = "Population Size", frame.plot = T)
points( total_embryo$population[total_embryo$treatment == "control"])
points(total_embryo$population[total_embryo$treatment == "4ppt"])
points(total_embryo$population[total_embryo$treatment == "6ppt"])
axis(side = 1, at = 1:3, labels = c("Control", "4ppt", "6ppt"))
axis(side = 2)





```

``` {R Old stuff that may need for examples}
embryo$treatment <- factor(embryo$treatment, levels = c('control', '4ppt', '6ppt'))

#gives blank ggplot
ggplot(data = embryo, aes(x = treatment, y = day_7))

# a boxplot
embryo_glm <- glm(day_7 ~ treatment, data = embryo, family = "poisson")
summary(embryo_glm)
#psuedo r2



```
